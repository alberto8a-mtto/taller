<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte Rodamiento | Gestión de Taller</title>
  <link rel="stylesheet" href="styles.css">
  <!-- <script src="google-sheets.js"></script> -->
</head>
<body>
  <div class="rodamiento-container">
    <div class="rodamiento-card card">
      <h2>Nuevo Reporte - Área Rodamiento</h2>
      <form id="formRodamiento">
        <div class="form-group">
          <label for="numero_vehiculo">Número de Vehículo *</label>
          <input type="text" id="numero_vehiculo" required placeholder="Ej: 001, 002, VH-123">
        </div>
        <div class="form-group">
          <label for="nombre_conductor">Nombre del Conductor *</label>
          <input type="text" id="nombre_conductor" required placeholder="Ej: Juan Pérez">
        </div>
        <div class="form-group">
          <label for="descripcion">Descripción *</label>
          <textarea id="descripcion" required rows="4" placeholder="Describe la novedad..."></textarea>
        </div>
        <input type="hidden" id="area" value="RODAMIENTO">
        <button type="submit" class="btn btn-primary">Registrar Reporte</button>
      </form>
      <div id="mensajeRodamiento" style="margin-top:1.5rem;"></div>
    </div>
  </div>
  <script src="google-apps-script.js"></script>
  <script>
    document.getElementById('formRodamiento').addEventListener('submit', async function(e) {
      e.preventDefault();
      const numero_vehiculo = document.getElementById('numero_vehiculo').value.trim();
      const nombre_conductor = document.getElementById('nombre_conductor').value.trim();
      const descripcion = document.getElementById('descripcion').value.trim();
      const area = document.getElementById('area').value;
      if (!numero_vehiculo || !nombre_conductor || !descripcion) {
        document.getElementById('mensajeRodamiento').innerHTML = '<span style="color:red">Todos los campos obligatorios deben estar completos.</span>';
        return;
      }
      // Crear reporte con área Rodamiento (solo datos básicos)
      let reportes = await googleSheets.leerReportes();
      const nextId = reportes.length > 0 ? Math.max(...reportes.map(r => r.id)) + 1 : 1;
      const nuevoReporte = {
        id: nextId,
        numero_vehiculo,
        nombre_conductor,
        estado: 'REPORTE',
        descripcion,
        area,
        fecha_reporte: new Date().toISOString(),
        fecha_actualizacion: new Date().toISOString()
      };
      reportes.push(nuevoReporte);
      await googleSheets.guardarReportes(reportes);
      document.getElementById('mensajeRodamiento').innerHTML = '<span style="color:green">Reporte registrado correctamente.</span>';
      document.getElementById('formRodamiento').reset();
    });
  </script>
</body>
</html>
